---
- name: Upload /etc/zookeeper.env template
  sudo: yes
  template:
    src: zookeeper.env.j2
    dest: /etc/zookeeper.env
    mode: 0600
  register: zookeeper_env
  notify:
  - Restart Zookeper Node
  
- name: Copy zookeeper.service
  sudo: yes
  copy:
    src: zookeeper.service
    dest: /etc/systemd/system/zookeeper.service
  register: zookeeper_service
  notify:
  - Restart Zookeper Node
  
- name: Ensure that data path exists
  sudo: yes
  file:
    path: "{{ zookeeper_data }}"
    state: directory
    mode: 0755
  
- name: Reload SystemD
  sudo: yes
  command: systemctl daemon-reload
  when: zookeeper_service.changed
  
- name: Docker pull image
  command: "/usr/bin/docker pull cleawing/zookeeper:{{ zookeeper_version }}"
  when: zookeeper_env.changed


